commands:
  01_install_docker:
    command: |
      if ! command -v docker &> /dev/null; then
        dnf install -y docker
      fi
      systemctl enable docker
      systemctl start docker
      # Wait for Docker daemon to be ready
      for i in $(seq 1 30); do
        docker info &>/dev/null && break
        sleep 1
      done
    ignoreErrors: false

  02_start_duckling:
    command: |
      # Stop any existing Duckling container
      docker rm -f duckling 2>/dev/null || true
      # Run Duckling on localhost:8050 (port 8000 is used by Gunicorn)
      docker run -d \
        --name duckling \
        --restart always \
        -p 8050:8000 \
        rasa/duckling
    ignoreErrors: false
